# データ辞書

作成日: 2026-02-17  
対象ブック: `excel/見積原価管理システム.xlsm`

## 1. 共通ルール

- ヘッダ行は原則4行目、データ開始は5行目
- 実データとテンプレート行（数式プリセット）を区別して扱う
- ID体系
  - 案件ID: `P-001` 形式
  - 顧客ID: `C-001` 形式
  - 業者ID: 現行は数値ID（1,2,3...）
  - 請求ID: `INV-001` 形式（自動式）
  - 支払ID: `PAY-001` 形式（自動式）

## 2. エンティティ一覧

| 論理名 | 元シート | キー | 用途 |
|---|---|---|---|
| Project | 案件管理 | 案件ID(A) | 案件ライフサイクル管理 |
| Customer | 顧客マスタ | 顧客ID(A) | 顧客属性管理 |
| Vendor | 業者DB | ID(A) | 協力会社管理 |
| WorkItemMaster | 工事項目DB | ID(A) | 見積単価マスタ |
| Invoice | 請求管理 | 請求ID(A) | 請求/入金管理 |
| Payment | 支払管理 | 支払ID(A) | 発注/支払管理 |

## 3. Project（案件管理）

### 3.1 カラム定義

| 列 | 物理名 | 論理名 | 型 | 必須 | 備考 |
|---|---|---|---|---|---|
| A | 案件ID | project_id | text | yes | `P-\d{3}` |
| B | 顧客ID | customer_id | text | yes | `C-\d{3}` |
| C | 顧客名 | customer_name | text | yes | 顧客マスタ参照値 |
| D | 案件名 | project_name | text | yes | 物件名 |
| E | 工事内容 | project_type | text | no | リスト入力 |
| F | 見積金額 | quote_amount | number | no | 案件シート `K50` |
| G | 実行予算 | budget_amount | number | no | 案件シート `G50` |
| H | 粗利率 | gross_margin_rate | formula | no | `(F-G)/F` |
| I | ステータス | project_status | enum | yes | 7段階 |
| J | ステータス変更日 | status_updated_at | date | no | |
| K | 経過日数 | elapsed_days | formula | no | `TODAY()-J` |
| L | 滞留アラート | stagnation_alert | formula | no | 30日超判定 |
| M | 担当者 | owner_name | text | no | |
| N | 受注日 | won_at | date | no | |
| O | 着工予定日 | start_planned_at | date | no | |
| P | 完工日 | completed_at | date | no | |
| Q | 請求予定額 | invoice_planned_amount | number | no | |
| R | 失注理由 | lost_reason | text | no | |
| S | 作成日 | created_at | date | yes | 新規案件作成で投入 |
| T | 備考 | memo | text | no | |
| U | 完工予定日 | completion_planned_at | date | no | |
| V | 工期余日 | remaining_days | formula | no | `U-TODAY()` |
| W | 工期アラート | schedule_alert | formula | no | 超過/残日 |
| X | 請求書ステータス | invoice_status | enum | no | `✅発行済/❌未発行` |
| Y | 請求日 | invoice_date | date | no | |
| Z | 請求金額 | invoice_amount | number | no | |
| AA | 入金ステータス | payment_status | enum | no | `✅入金済/❌未入金` |
| AB | 入金日 | paid_at | date | no | |
| AC | 入金額 | paid_amount | number | no | |
| AD | 受注区分 | win_loss_flag | formula | no | 受注/失注/商談中 |
| AE | 施工住所 | site_address | text | no | 新規案件作成で投入 |
| AF | 物件名 | property_name | text | no | D列と同値運用 |

### 3.2 列挙型

- `project_status`
  - `①リード`
  - `②商談中`
  - `③見積作成中`
  - `④見積提出済`
  - `⑤受注`
  - `⑥失注`
  - `⑦完工`

## 4. Customer（顧客マスタ）

| 列 | 物理名 | 論理名 | 型 | 必須 | 備考 |
|---|---|---|---|---|---|
| A | 顧客ID | customer_id | text | yes | `C-\d{3}` |
| B | 区分 | customer_type | text | no | 法人/個人 |
| C | 会社名 / 氏名 | customer_name | text | yes | |
| D | 敷称 | honorific | text | no | |
| E | 担当者名 | contact_name | text | no | |
| F | 郵便番号 | postal_code | text | no | |
| G | 住所 | address | text | no | |
| H | 電話番号 | phone | text | no | |
| I | メール | email | text | no | |
| J | 紹介元 | referral_source | text | no | |
| K | 紹介元詳細 | referral_detail | text | no | |
| L | 累計案件数 | total_projects | number | no | 集計値 |
| M | 累計受注額 | total_won_amount | number | no | 集計値 |
| N | 最終取引日 | last_traded_at | date | no | |
| O | ランク | customer_rank | text | no | |
| P | 登録日 | registered_at | date | no | |
| Q | 更新日 | updated_at | date | no | |
| R | ステータス | status | text | no | |
| S | 備考 | note | text | no | |
| T | 特記事項 | special_note | text | no | |

## 5. Vendor（業者DB）

| 列 | 物理名 | 論理名 | 型 | 必須 | 備考 |
|---|---|---|---|---|---|
| A | ID | vendor_id | integer | yes | 現行は数値 |
| B | 業者名 | vendor_name | text | yes | |
| C | 代表者名 | representative_name | text | no | |
| D | 郵便番号 | postal_code | text | no | |
| E | 住所 | address | text | no | |
| F | 電話番号 | phone | text | no | |
| G | メール | email | text | no | |
| H | 得意工事 | specialty | text | no | |
| I | 支払条件 | payment_terms | text | no | |
| J | 備考 | note | text | no | |

## 6. WorkItemMaster（工事項目DB）

| 列 | 物理名 | 論理名 | 型 | 必須 | 備考 |
|---|---|---|---|---|---|
| A | ID | item_id | integer | yes | |
| B | 工事カテゴリ | category | text | yes | |
| C | 品名（小項目） | item_name | text | yes | |
| D | 仕様・形状 | spec | text | no | |
| E | 単位 | unit | text | no | |
| F | 標準単価 | standard_unit_price | number | no | |
| G | 業者名 | default_vendor_name | text | no | |
| H | 最終使用日 | last_used_at | date | no | |
| I | 利益率 | margin_rate | number | no | |
| J | 使用回数 | usage_count | number | no | |
| K | 案件名 | last_project_name | text | no | |
| L | 検索キー（自動） | search_key | formula | no | `B&"|"&C` |
| M | 登録日 | created_at | date | no | |

## 7. Invoice（請求管理）

| 列 | 物理名 | 論理名 | 型 | 必須 | 備考 |
|---|---|---|---|---|---|
| A | 請求ID | invoice_id | formula/text | yes | `INV-xxx`自動採番 |
| B | 案件ID | project_id | text | yes | `案件管理.A` 参照 |
| C | 案件名 | project_name | formula/text | no | VLOOKUP |
| D | 顧客名 | customer_name | formula/text | no | VLOOKUP |
| E | 請求種別 | invoice_type | text | no | 一括など |
| F | 請求日 | billed_at | date | no | |
| G | 請求額 | billed_amount | number | no | |
| H | 入金日 | paid_at | date | no | |
| I | 入金額 | paid_amount | number | no | |
| J | 残額 | remaining_amount | formula | no | `G-I` |
| K | ステータス | status | formula/text | no | 入金済/一部/未入金 |
| L | 備考 | note | text | no | |

## 8. Payment（支払管理）

| 列 | 物理名 | 論理名 | 型 | 必須 | 備考 |
|---|---|---|---|---|---|
| A | 支払ID | payment_id | formula/text | yes | `PAY-xxx`自動採番 |
| B | 案件ID | project_id | text | yes | |
| C | 業者ID | vendor_id | integer/text | yes | `業者DB.A` |
| D | 業者名 | vendor_name | formula/text | no | VLOOKUP |
| E | 工事内容 | work_description | text | no | |
| F | 発注日 | ordered_at | date | no | |
| G | 発注額 | ordered_amount | number | no | |
| H | 支払日 | paid_at | date | no | |
| I | 支払額 | paid_amount | number | no | |
| J | 残額 | remaining_amount | formula | no | `G-I` |
| K | ステータス | status | formula/text | no | 支払済/一部/未支払 |
| L | 支払条件 | payment_terms | formula/text | no | 業者DB参照 |
| M | 備考 | note | text | no | |

## 9. 参照関係（外部キー相当）

- `案件管理.B (顧客ID)` -> `顧客マスタ.A`
- `請求管理.B (案件ID)` -> `案件管理.A`
- `支払管理.B (案件ID)` -> `案件管理.A`
- `支払管理.C (業者ID)` -> `業者DB.A`
- `操作パネル.B7` -> `顧客マスタ.A5:A104`

## 10. アプリ移行時の正規化方針

- `案件管理` を中心に 1案件1レコード化（案件シート依存を排除）
- 帳票向けカテゴリ集計（B105:B124相当）は別テーブル化
- Excel絵文字ステータス（✅/❌/⚠）はアプリ側では enum + 表示ラベルへ分離

