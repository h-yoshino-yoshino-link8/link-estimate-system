# APP実装計画 (2026-02-17)

## 1. 目的

Excel/VBA依存を段階的に解消し、MVPとして以下3機能をWebアプリで提供する。

1. 新規案件作成
2. 見積書PDF出力（S表紙相当）
3. 領収書PDF出力

## 2. アーキテクチャ

- Frontend: Next.js (App Router, TypeScript)
- Backend: FastAPI (Python 3.9)
- DB: SQLite (開発用) / PostgreSQL互換設計
- PDF: ReportLabでサーバー生成

## 3. ディレクトリ構成

```text
app/
  api/
    app/
      main.py
      config.py
      database.py
      models.py
      schemas.py
      routers/
      services/
    tests/
    requirements.txt
  web/
    app/
      page.tsx
      layout.tsx
      globals.css
    package.json
```

## 4. 実装方針

## 4.1 API

- `GET /api/v1/customers`
- `POST /api/v1/projects`
- `GET /api/v1/projects`
- `POST /api/v1/documents/estimate-cover`
- `POST /api/v1/documents/receipt`

## 4.2 データモデル

- customers
- projects
- invoices

ID採番ルールはExcel互換:

- project_id: `P-001` 形式

## 4.3 PDF仕様

- 命名規則: `見積書_<案件名>_yyyymmdd.pdf`
- 命名規則: `領収書_<請求ID>_yyyymmdd.pdf`
- 禁則文字は `_` に置換

## 5. 開発ステップ

1. API基盤（DB/モデル/ルーター）
2. 新規案件作成と採番ロジック
3. PDF生成API
4. フロントUI（操作パネル相当）
5. テスト・ログ・コミット/プッシュ

## 6. 受入基準

- APIが起動し3機能が呼び出せる
- 案件ID採番が重複しない
- 2種PDFが命名規則でダウンロードできる
- 実行ログが `docs/EXECUTION_LOG_YYYYMMDD.md` に残る

## 7. 追加実装（2026-02-17 18:00時点）

- `POST /api/v1/sync/excel` を実装（顧客/案件/請求/工事項目の同期）
- `GET /api/v1/work-items` を実装
- `GET /api/v1/projects/{project_id}/items` を実装
- `POST /api/v1/projects/{project_id}/items` を実装
- Web操作パネルに以下を追加
  - Excel同期パネル
  - 案件明細登録パネル
  - 案件明細の一覧表示
